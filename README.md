# ros2_exam1 หุ่นยนต์เต่าหรรษาพพลัส
ในโปรแกรมนี้มีการควบคุมหุ่นยนต์ผ่านการป้อนคำสั่งจากคีย์บอร์ด (Teleoperation) เพื่อสั่งการให้ turtlesim_plus เคลื่อนที่ไปตามที่เราควบคุม 
โดยเริ่มจากการทำงานทั้งหมดอยู่ภายใน workspace ที่มีชื่อว่า exam1_ws จากนั้นได้ทำการสร้าง package 2 ส่วนได้แก่
![teleop_key (6)](https://github.com/user-attachments/assets/bbe3560c-e75a-4ddc-89dd-29f3c641d3f4)

# **ส่วนแรก** : ส่วน teleop เต่า โดยจะมี node ต่าง ๆ ดังนี้
  teleop_schedule.py - ทำหน้าที่จัดการการเปลี่ยนสถานะของหุ่นยนต์ จัดการ state 
  teleop_key.py - จัดการรับคำสั่งจากคีย์บอร์ดเพื่อควบคุมหุ่นยนต์
  controller.py - ตัวควบคุมหลักที่รวมการทำงานของหุ่นยนต์และการส่งคำสั่งการเคลื่อนไหว เป็นส่วนที่รวมระบบเข้าด้วยกัน

  
**การติดตั้ง**
1.โหลไฟล์ที่แนบมา
2.เข้าไปที่ workspace และ pkg
```
cd exam1_ws
```
3.colcon build ที่ workspace
```
colcon build
```

**การใช้งาน**
1. การรัน Teleop Schedule

ไฟล์ teleop_schedule.py ทำหน้าที่จัดการการตั้งค่าการทำงานหลักของหุ่นยนต์ และการเปลี่ยนสถานะของหุ่นยนต์ได้ตามต้องการ
```
ros2 run mission teleop_schedule
```

ฟังก์ชันหลัก:
    timer_callback() - ทำงานตามความถี่ที่ตั้งค่าไว้ เพื่อตรวจสอบสถานะของหุ่นยนต์และส่งข้อมูลออก
    switch_state_server_callback() - ฟังก์ชันที่รอรับคำสั่งเปลี่ยนสถานะจากผู้ใช้งานและส่งกลับไปยังหุ่นยนต์

2. การควบคุมหุ่นยนต์ด้วยคีย์บอร์ด

ไฟล์ teleop_key.py รับอินพุตจากคีย์บอร์ดเพื่อควบคุมการเคลื่อนไหวของหุ่นยนต์ เช่น เดินหน้า ถอยหลัง เลี้ยวซ้าย และเลี้ยวขวา
```
ros2 run your_package_name teleop_key
```

**ฟังก์ชันที่สำคัญ:**
    getKey(): ใช้ในการอ่านข้อมูลจากคีย์บอร์ดที่ผู้ใช้กด
    timer_callback(): ฟังก์ชันนี้ทำการตรวจสอบและส่งคำสั่งไปยังหุ่นยนต์ตามปุ่มที่กด

**ปุ่มควบคุม:**
    w - เดินหน้า
    a - เลี้ยวซ้าย
    s - ถอยหลัง
    d - เลี้ยวขวา
    i - spawn pizza
    o - save value to yaml file
    p - clear pizza 
    Ctrl+C - หยุดโปรแกรม

3. การควบคุมหุ่นยนต์ผ่าน Controller

ไฟล์ controller.py จัดการการเคลื่อนไหวและสถานะของหุ่นยนต์ ควบคุมการหมุนและความเร็ว ใช้ในการควบคุมเพื่อให้หุ่นยนต์เคลื่อนไหวอย่างราบรื่น
ฟังก์ชันหลัก:
    timer_callback() - ตรวจสอบสถานะและเคลื่อนที่ของหุ่นยนต์
    pose_callback() - รับตำแหน่งของหุ่นยนต์จากเซ็นเซอร์และคำนวณความเร็วที่ต้องการ
    walk_until_end() - ให้หุ่นยนต์เคลื่อนที่ไปยังตำแหน่งเป้าหมายตามคิวที่กำหนดไว้
    cmdvel() - ส่งคำสั่งการเคลื่อนที่ไปยังหุ่นยนต์ โดยจะมีค่าความเร็วและตำแหน่ง

# **interface**  



# **ส่วนที่สอง** : ส่วน teleop เต่า โดยจะมี node ต่าง ๆ ดังนี้
ในส่วนนี้ ต้องทำการ spawn turtle 4 ตัว โดยได้ทำการ spawn ผ่าน lauch file ต้องตั้งชื่อหุ่นยนต์เต่าตัวที่ 1 ว่า Foxy โดยจะมีหน้าที่วิ่งไปทิ้ง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 1
หุ่นยนต์เต่าตัวที่ 2 ชื่อ Noetic มีหน้าที่วิ่งไปทิ้ง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 2
หุ่นยนต์เต่าตัวที่ 3 ชื่อ Humble มีหน้าที่วิ่งไปทิ้ง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 3
หุ่นยนต์เต่าตัวที่ 4 ชื่อ Iron มีหน้าที่วิ่งไปทิ้ง Pizza ตามชุดตำแหน่งที่ได้จากการ save ครั้งที่ 4
ซึ่งมีข้อจำกัดในการเขียนโค้ดคือ ต้องทำการนำชื่อเข้า FUNCTION for loop เพื่อทำการเติมชื่อเข้าไปที่เต่าแต่ละตัว

ในที่นี้ได้ทำการ spawn turtle ที่จุดเริ่มต้นทางด้านล่างซ้าย แล้วทำการรับค่าจากไฟล์ yaml ทำให้ได้ค่าตำแหน่งที่ต้องการให้เต่าเคลื่อนที่ไปแล้วทำการทิ้งพิซซ่า 

